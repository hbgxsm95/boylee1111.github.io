<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Func&lt;T&gt; and Expression&lt;Func&lt;T&gt;&gt; &#8211; Boyi Li</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="When I used <code>Func&lt;T&gt;</code>&nbsp;or <code>Expression&lt;Func&lt;T&gt;&gt;</code>&nbsp;as parameter of function, I found both ...">
    <meta name="author" content="John Otander">
    <meta name="keywords" content="development">
    <link rel="canonical" href="http://boylee.me/development/2014/08/12/func-and-expression/">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/pixyll.css" type="text/css">

    <!-- Fonts -->
    <link href='//fonts.googleapis.com/css?family=Merriweather:900,900italic,300,300italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Lato:900,300' rel='stylesheet' type='text/css'>
    
      <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
    

    <link rel="stylesheet" href="/css/boylee.css" type="text/css">

    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: { inlineMath: [['$','$'], ['\\(','\\)'], ['[latex]','[/latex]']] },
            menuSettings: {
                zoom: "Double-Click",
                zscale: "200%"
            },
            showProcessingMessages: false,
            showMathMenu: false,
            showMathMenuMSIE: false,
            messageStyle: "none"
        });
    </script>
    <script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>
    <script type="text/javascript" src="/javascripts/main.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

    <!-- Open Graph -->
    <!-- From: https://github.com/mmistakes/hpstr-jekyll-theme/blob/master/_includes/head.html -->
    <meta property="og:locale" content="en_US">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Func&lt;T&gt; and Expression&lt;Func&lt;T&gt;&gt;">
    <meta property="og:description" content="A simple, beautiful theme for Jekyll that emphasizes content rather than aesthetic fluff.">
    <meta property="og:url" content="http://boylee.me/development/2014/08/12/func-and-expression/">
    <meta property="og:site_name" content="Boyi Li">
</head>

<body class="animated fade-in-down">
  <div class="site-wrap">
    <header class="site-header px2 px-responsive">
  <div class="mt2 wrap">
    <div class="measure">
      <a href="http://boylee.me" class="site-title">Boyi Li</a>
      <nav class="site-nav right">
        <a href="/categories/">Categories</a>
<a href="/tags/">Tags</a>
<a href="/about/">About</a>

      </nav>
      <div class="clearfix"></div>
      
        <div class="social-icons">
  <div class="left">
    
      <a class="fa fa-github-alt" href="https://github.com/boylee1111"></a>
    
    <a class="fa fa-rss" href="/feed.xml"></a>
    
      <a class="fa fa-envelope mailTo" href="#It's My Fucking Email!^_^"></a>
    
    
      <a class="fa fa-linkedin-square" href="https://www.linkedin.com/in/boylee"></a>
    
  </div>
  <div class="right">
    
      <a class="fa fa fa-weibo", href="http://www.weibo.com/boylee1111"></a>
    
    
      <a class="fa fa-facebook-square", href="https://facebook.com/boylee1111"></a>
    
    
      <a class="fa fa-twitter" href="https://twitter.com/boylee1111"></a>
    
    
      <a class="fa fa-instagram" href="https://instagram.com/boylee1111"></a>
    
    
    
    
    
  </div>
</div>
<div class="clearfix"></div>

      
    </div>
  </div>
</header>


    <div class="post p2 p-responsive wrap" role="main">
      <div class="measure">
        


<div class="post-header mb2">
  <h1>Func&lt;T&gt; and Expression&lt;Func&lt;T&gt;&gt;</h1>
  <div>
    <span class="post-meta">Aug 12, 2014</span><br>
    
    <span class="post-meta small">2 minute read</span>
  </div>
</div>

<div class="bl-separator"></div>

<article class="post-content">
  <p>When I used <code>Func&lt;T&gt;</code> or <code>Expression&lt;Func&lt;T&gt;&gt;</code> as parameter of function, I found both are support <a href="http://msdn.microsoft.com/en-us/library/bb397687.aspx">lambda expression</a>, and most are literally the same. This made me think the difference between <code>Func&lt;T&gt;</code> and <code>Expression&lt;Func&lt;T&gt;&gt;</code>.</p>

<h2 id="funclttgt">Func&lt;T&gt;</h2>

<p><a href="http://msdn.microsoft.com/en-us/library/bb534960.aspx">Here</a> is MSDN official document. According to the definition, Func<t> is actually a simplified version of delegate.</t></p>

<div class="highlight"><pre><code class="language-c#" data-lang="c#"><span class="lineno">1</span> <span class="k">public</span> <span class="k">delegate</span> <span class="n">TResult</span> <span class="n">Func</span><span class="p">&lt;</span><span class="k">out</span> <span class="n">TResult</span><span class="p">&gt;()</span></code></pre></div>

<p><code>Func&lt;TResult&gt;</code>  assists developer to create delegate without explicit delegate declaration. The template T is the type of return value. In this way, the function can be assign to <code>Func&lt;TResult&gt;</code>  property and invoke directly. MS provides 17 delegate function, corresponding the count of parameters, the last template TResult is always type of return value.</p>

<p>Similarly, MS also provides <code>Action&lt;T&gt;</code> as simplified version of delegate, the only difference is <code>Action&lt;T&gt;</code> doesn’t support return value.</p>

<h2 id="expressionltfunclttgtgt">Expression&lt;Func&lt;T&gt;&gt;</h2>

<p><a href="http://msdn.microsoft.com/en-us/library/bb335710.aspx">Here</a> is MSDN official document. It accepts a delegate as template, generally is Func or Action. As MS describe, <code>Expression&lt;TDelegate&gt;</code> is a data structure in form of an expression tree, to represent a lambda expression.</p>

<p>Conceptually, it is just a data structure with all the information of lambda expression, not a real anonymous function, cannot be execute immediately. In other words, Func or Action will generate IL while compiling, but Expression just generates a structure.</p>

<p>There are two approaches to form a expression tree, one is through expression syntax itself, another is using API. Two ways below are the same.</p>

<div class="highlight"><pre><code class="language-c#" data-lang="c#"><span class="lineno">1</span> <span class="n">Expression</span><span class="p">&lt;</span><span class="n">Func</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;&gt;</span> <span class="n">expr</span><span class="p">;</span>
<span class="lineno">2</span> <span class="n">expr</span> <span class="p">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="m">10</span><span class="p">;</span> <span class="c1">// lambda expression syntax</span>
<span class="lineno">3</span> <span class="n">expr</span> <span class="p">=</span> <span class="n">Expression</span><span class="p">.</span><span class="n">Lambda</span><span class="p">&lt;</span><span class="n">Func</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;&gt;(</span><span class="n">Expression</span><span class="p">.</span><span class="n">Constant</span><span class="p">(</span><span class="m">10</span><span class="p">));</span> <span class="c1">// API</span></code></pre></div>

<p>And <code>Expression&lt;TDelegate&gt;</code> provides the <code>Compile()</code>  method. Through this, lambda expression can be compile at the runtime, the type of return value is the delegate after compiling. Then this function can be invoked manually.</p>

<p>By the way, expression tree is also an interesting thing, and worth discussion.</p>

<h2 id="summary">Summary</h2>

<p><code>Func&lt;TResult&gt;</code> and <code>Action&lt;T&gt;</code> is the another way to implement delegate, namely, like a function pointer. <code>Expression&lt;TDelegate&gt;</code> is a very interesting topic with many knowledge inside. Both bring many benefits for programming.</p>

<ul>
  <li>
    <p>One advantage of <code>Expression&lt;TDelegate&gt;</code> is that it contains many information of lambda expression. Through this, we can get some name as string format of property without “magical string”. <a href="http://blog.boylee.me/dev/wpf-interface-inotifypropertychanged/">Here</a> is an example. Nevertheless, this way will cost some performance of application.</p>
  </li>
  <li>
    <p>The most benefit thing of <code>Expression&lt;TDelegate&gt;</code> is applied in Entity Framework. <strong>IEnumerable works with Func and IQueryable works with Expression</strong>. What stores in IEnumerable is already localized, namely, store in memory. But IQueryable not, IQueryable take the feature of lambda expression, execute the code while localizing. So it will optimizes the lambda expression before compilation and execution. In this way, the database could get the efficient SQL operations.</p>
  </li>
</ul>

</article>



<!-- TODO: add shared -->
<div class="marT marB">
  <div class="bl-post-tags left">
    <div class="social-share">
      <a class="social-share-element icon-twitter" href="https://twitter.com/intent/tweet?text=Func&lt;T&gt; and Expression&lt;Func&lt;T&gt;&gt;&url=&via=OviliaZhang&hashtags=" target="_blank" title="Share this post on Twitter"></a>
      <a class="social-share-element" href="https://www.facebook.com/sharer/sharer.php?t=Func&lt;T&gt; and Expression&lt;Func&lt;T&gt;&gt;&u=" target="_blank" title="Share this post on Facebook"></a>
      <a class="social-share-element" id="social-google" href="https://plus.google.com/share?url=http://boylee.me/development/2014/08/12/func-and-expression/" target="_blank" title="Share this post on Google Plus"></a>
      <a class="social-share-element" id="social-linkedin" href="http://www.linkedin.com/shareArticle?mini=true&title=Func&lt;T&gt; and Expression&lt;Func&lt;T&gt;&gt;&url=&source=http%3a%2f%2fzhangwenli.com" target="_blank" title="Share this post on LinkedIn"></a>
      <a class="social-share-element" id="social-weibo" href="http://v.t.sina.com.cn/share/share.php?title=来看看+%40Ovilia允执厥中+的博文吧：Func&lt;T&gt; and Expression&lt;Func&lt;T&gt;&gt;&url=" target="_blank" title="Share this post on Sina Weibo"></a>
    </div>
  </div>
  <div class="bl-post-tags right">
  
  
  
    
      
      
    
      
      
        <a href="/tags/#.NET" class="bl-tag">
         .NET
        </a>
      
    
  
    
      
      
        <a href="/tags/#c#" class="bl-tag">
         c#
        </a>
      
    
      
      
    
  
  </div>
</div>
<br>
<div>
  <h3 class="comments-title">Comments</h3>
</div>
<div class="comments">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'boylee1111githubio'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>


  <h3 class="related-post-title">Related Posts</h3>
  
    <div class="post ml2">
      <a href="/development/2014/12/13/leetcode-add-two-numbers/" class="post-link">
        <h4 class="post-title">[LeetCode] Add Two Numbers</h4>
        <p class="post-summary">两个以链表形式存储的两个数相加，每一个结点代表一位，头结点为最低位，尾结点为最高位。</p>
      </a>
    </div>
  
    <div class="post ml2">
      <a href="/development/2014/12/13/leetcode-add-binary/" class="post-link">
        <h4 class="post-title">[LeetCode] Add Binary</h4>
        <p class="post-summary">字符串形式的二进制数相加，非常简单的字符串处理。每次找到相同位次的数相加，然后纪录一个进位即可。</p>
      </a>
    </div>
  
    <div class="post ml2">
      <a href="/development/2014/12/10/A-Real-World-Adapter-Pattern/" class="post-link">
        <h4 class="post-title">A Real World Adapter Pattern</h4>
        <p class="post-summary"></p>
      </a>
    </div>
  
    <div class="post ml2">
      <a href="/general/2014/11/28/%E5%AE%9E%E4%B9%A0%E7%BB%93%E6%9D%9F/" class="post-link">
        <h4 class="post-title">实习结束</h4>
        <p class="post-summary">长达近七个月的实习终于是画上句号了，最后一天跟老板在会议室进行了一次畅谈。首先是关于实习的分数的问题，按照德国人严谨的态度不难想象不可能全部拿到最高的分数，不过各项都还好，交流上分数不是满分。</p>
      </a>
    </div>
  
    <div class="post ml2">
      <a href="/development/2014/11/22/.Net-Choose-A-Right-Generic-Collection/" class="post-link">
        <h4 class="post-title">.NET -- Choose A Right Generic Collection</h4>
        <p class="post-summary">Recently, we discussed some collections of .NET Framework in our Conding Convention meeting. Though some details are explained, there are still some questions stay in my mind.</p>
      </a>
    </div>
  
    <div class="post ml2">
      <a href="/development/2014/11/20/Tips-For-Sorting-Tags-In-GitHub-Page-With-Jekyll/" class="post-link">
        <h4 class="post-title">Tips For Sorting Tags In GitHub Page With Jekyll</h4>
        <p class="post-summary">While adding <strong>Tags</strong> pages, I was stuck owing to the order of tags. Here are two different approaching of how to sort tags...</p>
      </a>
    </div>
  
    <div class="post ml2">
      <a href="/development/2014/11/17/Custom-MathJax-to-Solve-LaTeX-Legacy-Tag-Problem/" class="post-link">
        <h4 class="post-title">Custom MathJax to Solve LaTeX Legacy Tag Problem</h4>
        <p class="post-summary">After I migrated my blog from WordPress to Github Page, I chooose MathJax as rendering engine.</p>
      </a>
    </div>
  
    <div class="post ml2">
      <a href="/miscellaneous/2014/11/16/%E4%BB%8EWordPress%E5%88%B0Github-Pages/" class="post-link">
        <h4 class="post-title">从WordPress到Github Pages</h4>
        <p class="post-summary">因为买的Web Hosting要到期了，这才想起来赶紧把Blog移过来。</p>
      </a>
    </div>
  
    <div class="post ml2">
      <a href="/development/2014/11/14/leetcode-reverse-nodes-in-k-group/" class="post-link">
        <h4 class="post-title">[LeetCode] Reverse Nodes in k-Group</h4>
        <p class="post-summary">Advance version of Reverse Linked List II.</p>
      </a>
    </div>
  
    <div class="post ml2">
      <a href="/development/2014/11/14/leetcode-reverse-linked-list-ii/" class="post-link">
        <h4 class="post-title">[LeetCode] Reverse Linked List II</h4>
        <p class="post-summary">Reverse a linked list in a range. There are two steps to achieve this goal ...</p>
      </a>
    </div>
  

        
      </div>
    </div>    
  </div>
  <footer class="footer">
  <div class="p2 wrap">
    <div class="measure mt1 center">
      <small>Copyright &copy; 2014 Boyi Li.</small><br>
      <small>
        Thanks to <a href="http://johnotander.com" target="_blank">John Otander</a> (<a href="https://twitter.com/4lpine" target="_blank">@4lpine</a>) and <a href="http://jekyllrb.com" target="_blank">Jekyll</a>.
      </small>
    </div>
  </div>
</footer>


<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'true', 'auto');
ga('send', 'pageview');

</script>


</body>
</html>
